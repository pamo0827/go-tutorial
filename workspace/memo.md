### マルチモジュールワークスペース入門 まとめ

このチュートリアルでは、Go 1.18から導入された**ワークスペース (workspace)** という強力な機能を使って、複数のGoプロジェクト（モジュール）を同時に、かつ効率的に開発する方法を学びました。

### 1. 何が解決されたのか？ なぜワークスペースは便利なのか？

これまで、ローカルにある複数のモジュール（例: 自作ライブラリと、それを使うアプリケーション）を同時に開発するには、アプリケーション側の `go.mod` ファイルに `replace` ディレクティブを追記する必要がありました。

```go
unfold_lessgo
content_copyadd
// 以前の方法
replace example.com/greetings => ../greetings

```

この方法は機能しますが、以下のような欠点がありました。

- 開発のためだけに `go.mod` ファイルを書き換える必要があり、Gitでコミットしないように注意が必要だった。
- どのモジュールがローカル参照になっているか、`go.mod` を見ないと分からなかった。

**ワークスペース**は、これらの問題を解決します。`go.work` という専用ファイルで作業対象のモジュールを管理することで、**各モジュールの `go.mod` ファイルを一切汚さずに**、ローカルでの連携開発を実現します。

### 2. 学んだワークフローの要点

チュートリアルでは、以下のステップでワークスペースの基本的な使い方を体験しました。

1. **準備**:
    - 作業の親となるディレクトリ (`workspace`) を作成。
    - その中に、自分のアプリケーションとなる `hello` モジュールを作成 (`go mod init`)。
2. **ワークスペースの定義**:
    - `go work init ./hello` コマンドで、`go.work` ファイルを作成。これにより、Goは「ワークスペースモード」で動作を開始します。
3. **依存モジュールのローカル開発**:
    - 依存ライブラリである `golang.org/x/example` を `git clone` でローカルにダウンロード。
    - `go work use ./example/hello` コマンドで、ダウンロードしたライブラリもワークスペースに含めることをGoに指示。
    - この時点で、`go.work` ファイルには `hello` と `example/hello` の2つのモジュールがリストアップされます。
4. **モジュール間の連携と変更**:
    - ローカルの `example/hello/reverse` パッケージに新しい関数 `Int()` を追加。
    - `hello` アプリケーション側で、その新しい `Int()` 関数を呼び出すように `hello.go` を修正。
5. **実行と確認**:
    - ワークスペースのルートディレクトリから `go run ./hello` を実行。
    - Goコマンドは `go.work` ファイルを見て、`import "golang.org/x/example/hello/reverse"` を解決する際に、インターネット上のモジュールキャッシュではなく、**ローカルにある `example/hello` ディレクトリのコードを自動的に参照**します。
    - 結果として、追加したばかりの `Int()` 関数の実行結果が正しく表示されました。

### 3. 学んだ主要コマンド

- `go mod init <モジュール名>`: 新しいモジュールを開始する。
- `go work init <モジュールパス>`: 新しいワークスペースを開始し、`go.work` ファイルを作成する。
- `go work use <モジュールパス>`: 既存のワークスペースに、作業対象のモジュールを追加する。
- `go run ./<モジュール名>`: ワークスペースのルートから、指定したモジュールの `main` パッケージを実行する。